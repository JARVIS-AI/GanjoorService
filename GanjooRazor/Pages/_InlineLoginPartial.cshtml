@model GanjooRazor.Pages.LoginPartialEnabledPageModel
@using DNTPersianUtils.Core

<div id="main-navbar" role="navigation">

    <div class="clear-both">
        <div class="float-right display-inline-flex width-76px">
            <a onclick="switchSticky()" role="button" class="cursor-pointer float-right" title="چسبانی">
                <div class="noborder-btn color-white" id="pin_button">
                    <i class="noindent-info-button pin-button"></i>
                </div>
            </a>
        </div>

        @if (Model.LoggedIn)
        {
            <a href="/User" role="button" class="cursor-pointer" title="پیشخان کاربر">
                <div class="circled-number">
                    <i class="noindent-info-button user-home-icon"></i>
                </div>
            </a>
            <a href="/User/MyBookmarks" role="button" class="cursor-pointer" title="نشان‌شده‌های من">
                <div class="circled-number">
                    <i class="noindent-info-button bookmarking-icon"></i>
                </div>
            </a>
            <a href="/User/Notifications" role="button" class="w3tooltip cursor-pointer">
                <div class="circled-number">
                    <i class="noindent-info-button notifications-icon"><span id="notification-badge" class="hidden-recitation"></span></i>
                </div>
                <span class="w3tooltiptext">اعلان‌های من</span>
            </a>
            <a href="/User/History" role="button" class="cursor-pointer" title="ادامهٔ مطالعه">
                <div class="circled-number">
                    <i class="noindent-info-button history-icon"></i>
                </div>
            </a>

            <a href="/login" role="button" class="cursor-pointer" title="خروج">
                <div class="circled-number">
                    <i class="noindent-info-button logout-icon"></i>
                </div>
            </a>
        }
        else
        {
            <a onclick="document.getElementById('id01').style.display='block'" role="button" class="cursor-pointer pagebutton" style="display:inline-table;border: 3px solid black">
                ورود کاربر / نام‌نویسی <i class="noindent-info-button account-icon"></i>
            </a>
        }

        <div class="float-left display-inline-flex width-76px">

            <a href="#footer" role="button" class="cursor-pointer" title="پایین صفحه">
                <div class="noborder-btn">
                    <i class="noindent-info-button down-btn"></i>
                </div>
            </a>

            <a href="#" role="button" class="cursor-pointer" title="بالای صفحه">
                <div class="noborder-btn">
                    <i class="noindent-info-button up-btn"></i>
                </div>
            </a>

        </div>

    </div>

    @if (Model.GanjoorPage != null && Model.GanjoorPage.Poem != null)
    {
        <div class="clear-both">

            <a href="#tools" role="button" class="w3tooltip cursor-pointer">
                <div class="circled-number">
                    <i class="noindent-info-button edit-poem-button"></i>
                </div>
                <span class="w3tooltiptext">اطلاعات</span>
            </a>

            <a href="#discussions" role="button" class="w3tooltip cursor-pointer">
                <div class="circled-number">
                    <i class="noindent-info-button recitation-comments"></i>
                </div>
                <span class="w3tooltiptext">حاشیه‌ها</span>
            </a>

            <a href="#manuscripts" role="button" class="w3tooltip cursor-pointer">
                <div class="circled-number">
                    <i class="noindent-info-button recitation-manuscripts"></i>
                </div>
                <span class="w3tooltiptext">نگاره‌ها</span>
            </a>

            <a href="#songs" role="button" class="w3tooltip cursor-pointer">
                <div class="circled-number">
                    <i class="noindent-info-button recitation-music"></i>
                </div>
                <span class="w3tooltiptext">ترانه‌ها</span>
            </a>

            @if (Model.SectionsWithRelated.Count > 0)
            {
                <a href="#rpoems" role="button" class="w3tooltip cursor-pointer">
                    <div class="circled-number">
                        <i class="noindent-info-button recitation-explore"></i>
                    </div>
                    <span class="w3tooltiptext">هم‌آهنگ‌ها</span>
                </a>
            }

            @if (Model.GanjoorPage.Poem.Recitations.Length > 0)
            {
                <a href="#recitations" role="button" class="w3tooltip cursor-pointer">
                    <div class="circled-number">
                        <i class="noindent-info-button recitation-listen"></i>
                    </div>
                    <span class="w3tooltiptext">خوانش‌ها</span>
                </a>
            }

            <a onclick="btshmr(@Model.GanjoorPage.Id)" role="button" class="w3tooltip cursor-pointer">
                <div class="circled-number">
                    <i class="noindent-info-button format_list_numbered_rtl" id="bnum-button"></i>
                </div>
                <span class="w3tooltiptext">شماره‌گذاری</span>
            </a>

            <a onclick="copyPoemLink()" role="button" class="w3tooltip cursor-pointer">
                <div class="circled-number">
                    <i class="noindent-info-button copylink-icon"></i>
                </div>
                <span class="w3tooltiptext" id="copylink-tooltip">رونوشت نشانی</span>
            </a>

            <a onclick="copyPoemText()" role="button" class="w3tooltip cursor-pointer">
                <div class="circled-number">
                    <i class="noindent-info-button copytext-icon"></i>
                </div>
                <span class="w3tooltiptext" id="copytext-tooltip">رونوشت متن</span>
            </a>

            <a onclick="webSharePoem()" role="button" class="w3tooltip cursor-pointer" id="share_span">
                <div class="circled-number">
                    <i class="noindent-info-button share-icon"></i>
                </div>
                <span class="w3tooltiptext">همرسانی</span>
            </a>

            @if (Model.SectionsWithMetreAndRhymes != null)
            {
                @if (Model.SectionsWithMetreAndRhymes.Any())
                {
                    <text>
                        <a href="@Html.Raw($"/simi/?v={Uri.EscapeDataString(Model.SectionsWithMetreAndRhymes.First().GanjoorMetre.Rhythm)}&amp;g={Uri.EscapeDataString(Model.SectionsWithMetreAndRhymes.First().RhymeLetters)}")" role="button" class="w3tooltip cursor-pointer">
                            <div class="circled-number">
                                <i class="noindent-info-button rhyming-poems"></i>
                            </div>
                            <span class="w3tooltiptext">موارد هم آهنگ</span>
                        </a>
                    </text>

                    @for (int nSectionIndex = 1; nSectionIndex < Model.SectionsWithMetreAndRhymes.Count; nSectionIndex++)
                    {
                        <text>
                            <a href="@Html.Raw($"/simi/?v={Uri.EscapeDataString(Model.SectionsWithMetreAndRhymes[nSectionIndex].GanjoorMetre.Rhythm)}&amp;g={Uri.EscapeDataString(Model.SectionsWithMetreAndRhymes[nSectionIndex].RhymeLetters)}")" role="button" class="w3tooltip cursor-pointer">
                                <div class="circled-number">
                                    <i class="noindent-info-button rhyming-poems"></i>
                                </div>
                                <span class="w3tooltiptext">موارد هم آهنگ (وزن @((nSectionIndex + 1).ToPersianNumbers()))</span>
                            </a>
                        </text>
                    }
                }
            }

            <a href="/t6e?p=@Model.GanjoorPage.Id" role="button" class="w3tooltip cursor-pointer" target="_blank">
                <div class="circled-number">
                    <i class="noindent-info-button menu-book"></i>
                </div>
                <span class="w3tooltiptext">نمای چاپی</span>
            </a>

            @if (Model.LoggedIn)
            {
                <a onclick="switchBookmark(@Model.GanjoorPage.Id, 0, '')" role="button" class="w3tooltip cursor-pointer">
                    <div class="circled-number" id="bookmark">
                        <i class="noindent-info-button" id="bookmark-icon">star_border</i>
                    </div>
                    <span class="w3tooltiptext">نشان کردن</span>
                </a>

                <a href="/User/Editor?id=@Model.GanjoorPage.Id" role="button" class="w3tooltip cursor-pointer">
                    <div class="circled-number">
                        <i class="noindent-info-button edit-poem-button"></i>
                    </div>
                    <span class="w3tooltiptext">ویرایش</span>
                </a>
            }

        </div>
    }

</div>

@if (Model.LoggedIn)
{
    <script>
        CheckIfHasNotificationsForHomePage();
    </script>
}
else
{
    <!-- The Modal -->
    <div id="id01" class="modal">
        <span onclick="document.getElementById('id01').style.display='none'"
          class="close" title="بستن">&times;</span>

        <!-- Modal Content -->
        <form class="modal-content animate" method="post" action="?handler=Login">
            <div class="imgcontainer">
                <img src="/image/login.png" alt="گنجور" class="avatar">
            </div>
            <table style="width:100%">
                <tr>
                    <td colspan="2">
                        <h2>
                            ورود به گنجور
                        </h2>
                    </td>
                </tr>
                <tr>
                    <td>
                        <span class="inputlabel">پست الکترونیکی: </span>
                    </td>
                    <td>
                        <input type="email" style="text-align:left;direction:ltr;width:100%" placeholder="پست الکترونیکی" asp-for="LoginViewModel.Username" />
                    </td>
                </tr>
                <tr>
                    <td>
                        <span class="inputlabel">گذرواژه: </span>
                    </td>
                    <td>
                        <input type="password" id="password" style="text-align:left;direction:ltr;width:100%" placeholder="گذرواژه" asp-for="LoginViewModel.Password" />
                    </td>
                </tr>
                <tr>
                    <td></td>
                    <td><input type="submit" name="submit" style="width:100%;cursor:pointer" id="submit" value="ورود" /></td>
                </tr>
                <tr>
                    <td></td>
                    <td>
                        <table style="width:100%; margin:0">
                            <tr>
                                <td>
                                    <input type="button" onclick="location.href='/signup'" class="cancelbtn" style="width:100%;text-align:center;cursor:pointer" value="نام‌نویسی" />
                                </td>
                                <td>
                                    <input type="button" onclick="location.href='/resetpassword'" class="cancelbtn" style="width:100%;text-align:center;cursor:pointer" value="فراموشی گذرواژه" />
                                </td>
                            </tr>
                            <tr>
                                <td colspan="2">
                                    <input type="button" onclick="document.getElementById('id01').style.display='none'" style="width: 100%; text-align: center; cursor: pointer" value="انصراف" />
                                </td>
                            </tr>
                        </table>
                    </td>
                </tr>
                <tr>
                    <td colspan="2">
                        <p>
                            اگر پیشتر در <a href="https://museum.ganjoor.net" target="_blank">گنجینه</a> یا <a href="https://gaudiopanel.ganjoor.net" target="_blank">پیشخان خوانشگران</a> گنجور نام‌نویسی کرده‌اید می‌توانید با همان اطلاعات کاربری به گنجور وارد شوید.
                        </p>
                    </td>
                </tr>

            </table>

        </form>

    </div>
}
